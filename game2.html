<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç‰æ¡‚ç‹—æ‡‰ç”¨é¡Œè€å¸«</title>
    <style>
        :root { --cinna-blue: #b3e5fc; --cinna-pink: #ffc1e3; --bg: #f9feff; }
        body { font-family: 'Noto Sans TC', sans-serif; background-color: var(--bg); margin: 0; padding: 15px; text-align: center; }
        
        .card { background: white; border-radius: 25px; border: 3px solid var(--cinna-blue); padding: 20px; max-width: 500px; margin: 0 auto; box-shadow: 0 8px 15px rgba(0,0,0,0.05); }
        .problem-text { font-size: 1.3rem; line-height: 1.8; color: #455a64; text-align: left; margin-bottom: 20px; min-height: 100px; }
        .keyword { color: #f06292; font-weight: bold; text-decoration: underline; }
        
        .option-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
        .opt-btn { background: white; border: 2px solid var(--cinna-blue); padding: 15px; border-radius: 15px; font-size: 1.1rem; cursor: pointer; transition: 0.2s; }
        .opt-btn:active { background: var(--cinna-blue); color: white; }
        
        .answer-box { margin-top: 20px; display: none; }
        #final-ans { width: 100px; font-size: 1.5rem; border: none; border-bottom: 3px solid var(--cinna-pink); text-align: center; outline: none; }
        
        .reward { font-size: 3rem; margin-top: 15px; display: none; animation: pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes pop { 0% { transform: scale(0); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

    <div class="card">
        <div style="font-size: 0.9rem; color: #999; margin-bottom: 10px;">P3 æ‡‰ç”¨é¡ŒæŒ‘æˆ° ğŸŒŸ</div>
        <div id="problem-display" class="problem-text">æ­£åœ¨è¼‰å…¥é¡Œç›®...</div>
        
        <button onclick="sayProblem()" style="background:none; border:none; font-size:2rem; cursor:pointer;">ğŸ”Š</button>
        
        <div id="step-1">
            <p style="color: #0288d1; font-weight: bold;">æ­¥é©Ÿ 1ï¼šé€™é¡Œæ‡‰è©²ç”¨ä»€éº¼æ–¹æ³•è¨ˆç®—ï¼Ÿ</p>
            <div class="option-grid">
                <button class="opt-btn" onclick="checkStep1('+')">åŠ æ³• (+)</button>
                <button class="opt-btn" onclick="checkStep1('-')">æ¸›æ³• (-)</button>
                <button class="opt-btn" onclick="checkStep1('x')">ä¹˜æ³• (Ã—)</button>
                <button class="opt-btn" onclick="checkStep1('Ã·')">é™¤æ³• (Ã·)</button>
            </div>
        </div>

        <div id="step-2" class="answer-box">
            <p style="color: #f06292; font-weight: bold;">æ­¥é©Ÿ 2ï¼šæœ€å¾Œç­”æ¡ˆæ˜¯å¤šå°‘ï¼Ÿ</p>
            <input type="number" id="final-ans" placeholder="?">
            <button class="opt-btn" style="background: var(--cinna-pink); color:white; border:none;" onclick="checkStep2()">æª¢æŸ¥ç­”æ¡ˆ</button>
        </div>

        <div id="reward-icon" class="reward">ğŸ§</div>
        <button id="next-btn" onclick="nextProblem()" style="display:none; margin-top:20px; background:var(--cinna-blue); color:white; border:none; padding:10px 20px; border-radius:20px;">ä¸‹ä¸€é¡Œ ğŸš€</button>
    </div>

    <script>
        const problems = [
            { 
                text: "ç‰æ¡‚ç‹—æœ‰ 12 ç›’é¤…ä¹¾ï¼Œæ¯ç›’æœ‰ 8 å¡Šï¼Œ<span class='keyword'>ä¸€å…±æœ‰</span>é¤…ä¹¾å¤šå°‘å¡Šï¼Ÿ", 
                op: 'x', 
                ans: 96,
                hint: "çœ‹åˆ°ã€æ¯ç›’æœ‰ã€å’Œã€ä¸€å…±ã€ï¼Œé€šå¸¸æ˜¯ç”¨ä¹˜æ³•å–”ï¼"
            },
            { 
                text: "è€å¸«æŠŠ 45 ç²’ç³–æœ<span class='keyword'>å¹³å‡åˆ†çµ¦</span> 5 ä½åŒå­¸ï¼Œæ¯äººå¯å¾—ç³–æœå¤šå°‘ç²’ï¼Ÿ", 
                op: 'Ã·', 
                ans: 9,
                hint: "ã€å¹³å‡åˆ†é…ã€æ˜¯é™¤æ³•çš„é—œéµå­—ï¼"
            },
            { 
                text: "æ›¸åŒ…åŸåƒ¹ 150 å…ƒï¼Œç¾åœ¨<span class='keyword'>æ¸›åƒ¹</span> 35 å…ƒï¼Œç¾åœ¨å”®åƒ¹æ˜¯å¤šå°‘å…ƒï¼Ÿ", 
                op: '-', 
                ans: 115,
                hint: "ã€æ¸›åƒ¹ã€ä»£è¡¨æ•¸é‡è®Šå°‘äº†ã€‚"
            }
        ];

        let currentP = 0;

        function loadProblem() {
            const p = problems[currentP];
            document.getElementById('problem-display').innerHTML = p.text;
            document.getElementById('step-1').style.display = 'block';
            document.getElementById('step-2').style.display = 'none';
            document.getElementById('reward-icon').style.display = 'none';
            document.getElementById('next-btn').style.display = 'none';
            document.getElementById('final-ans').value = '';
            sayProblem();
        }

        function checkStep1(userOp) {
            if (userOp === problems[currentP].op) {
                speak("ç­”å°äº†ï¼é¸å°é‹ç®—è™Ÿäº†ã€‚");
                document.getElementById('step-1').style.display = 'none';
                document.getElementById('step-2').style.display = 'block';
            } else {
                speak("å†æƒ³ä¸€æƒ³ï¼Œ" + problems[currentP].hint);
            }
        }

        function checkStep2() {
            const userAns = parseInt(document.getElementById('final-ans').value);
            if (userAns === problems[currentP].ans) {
                speak("å¤ªæ£’äº†ï¼è¨ˆç®—æ­£ç¢ºï¼");
                document.getElementById('reward-icon').innerText = ['ğŸ§','ğŸ­','ğŸ€','ğŸŒŸ'][Math.floor(Math.random()*4)];
                document.getElementById('reward-icon').style.display = 'block';
                document.getElementById('next-btn').style.display = 'inline-block';
            } else {
                speak("è¨ˆç®—éŒ¯äº†ï¼Œå†è©¦ä¸€æ¬¡ï¼");
            }
        }

        function nextProblem() {
            currentP = (currentP + 1) % problems.length;
            loadProblem();
        }

        function sayProblem() {
            const u = new SpeechSynthesisUtterance(problems[currentP].text.replace(/<[^>]*>/g, ''));
            u.lang = 'zh-HK'; u.rate = 0.8;
            window.speechSynthesis.speak(u);
        }

        function speak(t) {
            const u = new SpeechSynthesisUtterance(t);
            u.lang = 'zh-HK'; window.speechSynthesis.speak(u);
        }

        window.onload = loadProblem;
    </script>
</body>
</html>
