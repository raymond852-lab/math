<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç‰æ¡‚ç‹— P3 å…¨ç§‘è‡ªä¸»æº«ç¿’ç«™</title>
    <script src="https://cdn.jsdelivr.net/npm/hanzi-writer@3.5/dist/hanzi-writer.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --cinna-blue: #b3e5fc; --cinna-dark-blue: #0288d1; --cinna-pink: #ffc1e3; --cinna-dark-pink: #f06292; --bg: #f0faff; }
        body { font-family: 'Noto Sans TC', sans-serif; background-color: var(--bg); margin: 0; padding: 0; text-align: center; user-select: none; -webkit-user-select: none; }
        
        /* é€šç”¨ä½ˆå±€ */
        .screen { display: none; padding: 20px; min-height: 100vh; box-sizing: border-box; flex-direction: column; align-items: center; }
        .screen.active { display: flex; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .card { background: white; border-radius: 25px; border: 3px solid var(--cinna-blue); padding: 20px; width: 100%; max-width: 500px; box-shadow: 0 10px 20px rgba(179,229,252,0.3); margin-bottom: 20px; position: relative; }
        
        h1, h2, h3 { margin: 10px 0; color: #546e7a; }
        .btn { background: white; border: 2px solid var(--cinna-blue); padding: 15px; border-radius: 15px; font-size: 1.1rem; cursor: pointer; width: 100%; margin-bottom: 10px; font-weight: bold; color: #555; transition: 0.1s; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn:active { transform: scale(0.98); background: var(--cinna-blue); color: white; }
        .btn-primary { background: var(--cinna-pink); color: white; border: none; box-shadow: 0 5px 0 var(--cinna-dark-pink); font-size: 1.3rem; }
        .btn-primary:active { box-shadow: 0 2px 0 var(--cinna-dark-pink); transform: translateY(3px); }
        .btn-back { position: fixed; top: 10px; left: 10px; background: rgba(255,255,255,0.8); border: 1px solid #ddd; padding: 5px 15px; border-radius: 20px; z-index: 100; font-size: 0.9rem; cursor: pointer; }

        /* çå‹µç‰¹æ•ˆ */
        .reward-overlay { position: fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:999; display:none; justify-content:center; align-items:center; }
        .reward-emoji { font-size: 5rem; animation: popUp 0.8s forwards; }
        @keyframes popUp { 0% { transform: scale(0); opacity: 0; } 50% { transform: scale(1.5); opacity: 1; } 100% { transform: scale(1); opacity: 0; } }

        /* ä¸­æ–‡é»˜æ›¸ç‰¹å®šæ¨£å¼ */
        #writer-canvas { display: block; margin: 0 auto; cursor: crosshair; touch-action: none; }
        .history-item { background: #f9f9f9; padding: 8px; border-radius: 8px; margin: 5px 0; font-size: 0.8rem; text-align: left; cursor: pointer; border: 1px solid #eee; }
        
        /* æ•¸å­¸ç‰¹å®šæ¨£å¼ */
        .math-input { width: 80px; font-size: 1.5rem; border: none; border-bottom: 3px solid var(--cinna-pink); text-align: center; outline: none; background: transparent; }
        .keyword { color: var(--cinna-dark-pink); font-weight: bold; border-bottom: 2px dashed var(--cinna-dark-pink); }
        #clock-canvas { background: white; border-radius: 50%; border: 6px solid #546e7a; margin: 10px auto; display: block; max-width: 100%; }
        .digital-clock { background: #333; color: #0f0; font-family: monospace; padding: 5px 15px; border-radius: 8px; font-size: 1.8rem; display: inline-block; margin-top: 10px; }
    </style>
</head>
<body>

    <button id="global-back" class="btn-back" onclick="goHome()" style="display:none;">â¬… å›é¸å–®</button>

    <div id="reward-layer" class="reward-overlay"><div id="reward-icon" class="reward-emoji">ğŸŒŸ</div></div>

    <div id="screen-home" class="screen active">
        <div style="font-size: 4rem; margin-top: 30px;">ğŸ¶</div>
        <h1 style="color:var(--cinna-dark-blue)">P3 è‡ªä¸»æº«ç¿’ç«™</h1>
        <p style="color:#777; margin-bottom: 30px;">é¸æ“‡ä»Šå¤©è¦æŒ‘æˆ°çš„ç§‘ç›®ï¼š</p>
        
        <div class="card">
            <button class="btn" onclick="goTo('dictation-setup')" style="border-color: var(--cinna-dark-pink); color: var(--cinna-dark-pink);">
                ğŸ“ ä¸­æ–‡é»˜æ›¸ <span style="font-size:0.8rem; background:#eee; padding:2px 6px; border-radius:10px;">èªéŸ³/æ‰‹å¯«</span>
            </button>
            <button class="btn" onclick="goTo('math-menu')" style="border-color: var(--cinna-dark-blue); color: var(--cinna-dark-blue);">
                ğŸ§® æ•¸å­¸ç‰¹è¨“ <span style="font-size:0.8rem; background:#eee; padding:2px 6px; border-radius:10px;">L1 - L3</span>
            </button>
        </div>
        <div style="font-size: 0.8rem; color: #aaa; margin-top: auto;">Designed for P3 Students</div>
    </div>

    <div id="screen-dictation-setup" class="screen">
        <h2>ä¸­æ–‡é»˜æ›¸è¨­å®š</h2>
        <div class="card">
            <div style="display:flex; gap:10px; margin-bottom:15px;">
                <button id="mode-ipad" class="btn" style="background:var(--cinna-blue); color:white;" onclick="setDicMode('ipad')">ğŸ“± iPad é€å­—</button>
                <button id="mode-paper" class="btn" onclick="setDicMode('paper')">ğŸ“„ ç´™ç­†æ•´å¥</button>
            </div>
            
            <input type="text" id="dic-input" placeholder="è¼¸å…¥æˆ–è®€å‡ºèª²æ–‡..." style="width:100%; font-size:1.2rem; padding:10px; border:2px solid #ddd; border-radius:10px; margin-bottom:10px;">
            <button class="btn" onclick="startVoiceInput()" style="background:#e3f2fd; color:#1565c0;">ğŸ¤ èªéŸ³éŒ„å…¥</button>
            
            <div id="dic-history" style="max-height:100px; overflow-y:auto; margin:10px 0;"></div>
            
            <button class="btn-primary" onclick="startDictation()">ğŸš€ é–‹å§‹é»˜æ›¸</button>
        </div>
    </div>

    <div id="screen-dictation-run" class="screen">
        <div class="card">
            <div id="dic-progress" style="font-size:0.9rem; color:#999; margin-bottom:10px;"></div>
            <div id="dic-text-display" style="font-size:1.5rem; color:var(--cinna-dark-blue); font-weight:bold; min-height:40px;"></div>
            
            <div id="dic-canvas-area">
                <div style="border: 2px dashed #ddd; border-radius: 15px; margin: 10px auto; width: 280px; height: 280px; position:relative;">
                    <div id="writer-canvas"></div>
                </div>
                <button class="btn" onclick="dicHint()" style="background:#fff9c4; color:#fbc02d; border:none;">ğŸ’¡ æ•‘å‘½è‰</button>
            </div>

            <div id="dic-paper-area" style="display:none;">
                <p style="color:#666;">è«‹åœ¨ç´™ä¸Šé»˜å¯«ï¼Œå®Œæˆå¾ŒæŒ‰ä¸‹ä¸€æ­¥ã€‚</p>
            </div>

            <div style="display:flex; gap:10px; margin-top:15px;">
                <button class="btn" onclick="dicSpeak()" style="flex:1;">ğŸ”Š é‡è®€</button>
                <button id="dic-next-btn" class="btn-primary" onclick="dicNext()" style="flex:2; display:none;">ä¸‹ä¸€æ®µ â¡</button>
            </div>
        </div>
    </div>

    <div id="screen-math-menu" class="screen">
        <h2>æ•¸å­¸å¤§å†’éšª</h2>
        <div class="card">
            <button class="btn" onclick="initMathL1()">
                âš¡ Level 1ï¼šé€Ÿç®—ç‰¹è¨“ <br><small style="color:#999">åŠ æ¸›ä¹˜é™¤æ··åˆ</small>
            </button>
            <button class="btn" onclick="initMathL2()">
                ğŸ§  Level 2ï¼šæ‡‰ç”¨é¡Œé‚è¼¯ <br><small style="color:#999">æ‹†è§£é¡Œç›®é—œéµå­—</small>
            </button>
            <button class="btn" onclick="initMathL3()">
                â° Level 3ï¼šæ™‚é–“å¤§å¸« <br><small style="color:#999">æ¨¡æ“¬é˜èˆ‡è·¨æ™‚è¨ˆç®—</small>
            </button>
        </div>
    </div>

    <div id="screen-math-l1" class="screen">
        <div class="card">
            <span style="background:#ffecb3; padding:5px 10px; border-radius:15px; font-size:0.8rem;">Level 1 é€Ÿç®—</span>
            <div id="m1-q" style="font-size:3rem; color:#555; margin:20px 0;"></div>
            <input type="number" id="m1-ans" class="math-input" style="width:120px;" placeholder="?">
            <button class="btn-primary" onclick="checkMathL1()" style="margin-top:20px;">æäº¤</button>
            <div id="m1-msg" style="height:20px; color:red; margin-top:10px;"></div>
        </div>
    </div>

    <div id="screen-math-l2" class="screen">
        <div class="card">
            <span style="background:#c8e6c9; padding:5px 10px; border-radius:15px; font-size:0.8rem;">Level 2 æ‡‰ç”¨é¡Œ</span>
            <div id="m2-text" style="text-align:left; line-height:1.6; font-size:1.1rem; margin:15px 0; background:#f5f5f5; padding:10px; border-radius:10px;"></div>
            <button onclick="speakText(document.getElementById('m2-text').innerText)" style="background:none; border:none; cursor:pointer;">ğŸ”Š è®€é¡Œ</button>
            
            <div id="m2-step1">
                <p style="color:var(--cinna-dark-blue); font-weight:bold;">é€™é¡Œè¦æ€éº¼ç®—ï¼Ÿ</p>
                <div id="m2-ops" style="display:grid; grid-template-columns:1fr 1fr; gap:10px;"></div>
            </div>

            <div id="m2-step2" style="display:none; margin-top:15px;">
                <p style="color:var(--cinna-dark-pink); font-weight:bold;">ç­”æ¡ˆæ˜¯å¤šå°‘ï¼Ÿ</p>
                <input type="number" id="m2-ans" class="math-input">
                <button class="btn-primary" onclick="checkMathL2Final()" style="margin-top:10px;">æª¢æŸ¥</button>
            </div>
            <button id="m2-next" class="btn" style="display:none; margin-top:15px; background:#81c784; color:white;" onclick="initMathL2()">ä¸‹ä¸€é¡Œ</button>
        </div>
    </div>

    <div id="screen-math-l3" class="screen">
        <div class="card">
            <span style="background:#e1bee7; padding:5px 10px; border-radius:15px; font-size:0.8rem;">Level 3 æ™‚é–“</span>
            <canvas id="clock-canvas" width="200" height="200" style="display:none;"></canvas>
            <div id="digital-clock-wrap" style="display:none;"><div id="m3-d-clock" class="digital-clock">00:00</div></div>
            
            <div id="m3-text" style="margin:15px 0; text-align:left;"></div>
            <button onclick="speakText(document.getElementById('m3-text').innerText)" style="background:none; border:none;">ğŸ”Š</button>

            <div style="margin-top:20px;">
                <input type="number" id="m3-h" class="math-input" placeholder="æ™‚"> : 
                <input type="number" id="m3-m" class="math-input" placeholder="åˆ†">
            </div>
            <button class="btn-primary" onclick="checkMathL3()" style="margin-top:15px;">æäº¤</button>
            <button id="m3-next" class="btn" style="display:none; margin-top:15px; background:#81c784; color:white;" onclick="initMathL3()">ä¸‹ä¸€é¡Œ</button>
        </div>
    </div>

    <script>
        // --- é€šç”¨åŠŸèƒ½ ---
        function goTo(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('screen-' + screenId).classList.add('active');
            document.getElementById('global-back').style.display = (screenId === 'home') ? 'none' : 'block';
            stopVoice();
        }

        function goHome() { goTo('home'); }

        function showReward() {
            const emojis = ['ğŸ†', 'ğŸ§', 'ğŸ­', 'âœ¨', 'ğŸ‰', 'ğŸ'];
            const el = document.getElementById('reward-icon');
            const layer = document.getElementById('reward-layer');
            el.innerText = emojis[Math.floor(Math.random() * emojis.length)];
            layer.style.display = 'flex';
            playSound('correct');
            setTimeout(() => { layer.style.display = 'none'; }, 800);
        }

        function speakText(text) {
            stopVoice();
            const u = new SpeechSynthesisUtterance(text);
            u.lang = 'zh-HK'; u.rate = 0.8;
            window.speechSynthesis.speak(u);
        }

        function stopVoice() { window.speechSynthesis.cancel(); }

        function playSound(type) {
            // ç°¡å–®éŸ³æ•ˆé‚è¼¯ï¼Œæ­¤è™•ä¸»è¦ä¾è³´èªéŸ³
            if(type === 'correct') speakText("ç­”å°äº†ï¼");
            else if(type === 'wrong') speakText("å†è©¦ä¸€æ¬¡");
        }

        // --- 1. ä¸­æ–‡é»˜æ›¸é‚è¼¯ ---
        let dicMode = 'ipad';
        let dicSegments = [];
        let dicIdx = 0;
        let writer = null;

        function setDicMode(m) {
            dicMode = m;
            document.getElementById('mode-ipad').style.background = m==='ipad'? 'var(--cinna-blue)' : 'white';
            document.getElementById('mode-ipad').style.color = m==='ipad'? 'white' : '#555';
            document.getElementById('mode-paper').style.background = m==='paper'? 'var(--cinna-blue)' : 'white';
            document.getElementById('mode-paper').style.color = m==='paper'? 'white' : '#555';
        }

        // èªéŸ³è¼¸å…¥
        function startVoiceInput() {
            const Speech = window.webkitSpeechRecognition || window.SpeechRecognition;
            if (!Speech) { alert("æ­¤ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³éŒ„å…¥ï¼Œè«‹æ‰‹å‹•è¼¸å…¥ã€‚"); return; }
            const rec = new Speech(); rec.lang = 'zh-HK';
            rec.start();
            rec.onresult = (e) => { document.getElementById('dic-input').value = e.results[0][0].transcript; };
        }

        // æ­·å²ç´€éŒ„
        function renderHistory() {
            const h = JSON.parse(localStorage.getItem('dicHistory') || '[]');
            const container = document.getElementById('dic-history');
            container.innerHTML = '';
            h.forEach(txt => {
                let d = document.createElement('div');
                d.className = 'history-item';
                d.innerText = txt.substring(0, 15) + '...';
                d.onclick = () => document.getElementById('dic-input').value = txt;
                container.appendChild(d);
            });
        }
        renderHistory();

        function startDictation() {
            const txt = document.getElementById('dic-input').value.trim();
            if(!txt) return alert("è«‹è¼¸å…¥èª²æ–‡");
            
            // å­˜ç´€éŒ„
            let h = JSON.parse(localStorage.getItem('dicHistory') || '[]');
            if(!h.includes(txt)) { h.unshift(txt); localStorage.setItem('dicHistory', JSON.stringify(h.slice(0,5))); renderHistory(); }

            if(dicMode === 'paper') dicSegments = txt.split(/([ï¼Œã€‚ï¼ï¼Ÿã€ï¼›\s]+)/).filter(s => s.trim().length > 0);
            else dicSegments = txt.split('').filter(s => s.trim().length > 0 && !/[ï¼Œã€‚ï¼ï¼Ÿ]/.test(s)); // iPad æ¨¡å¼åªå–æ¼¢å­—

            dicIdx = 0;
            goTo('dictation-run');
            runDicStep();
        }

        function runDicStep() {
            if(dicIdx >= dicSegments.length) {
                alert("é»˜æ›¸å®Œæˆï¼"); goTo('dictation-setup'); return;
            }
            const seg = dicSegments[dicIdx];
            document.getElementById('dic-progress').innerText = `${dicIdx+1} / ${dicSegments.length}`;
            
            if(dicMode === 'ipad') {
                document.getElementById('dic-canvas-area').style.display = 'block';
                document.getElementById('dic-paper-area').style.display = 'none';
                document.getElementById('dic-text-display').innerText = ""; // éš±è—æ–‡å­—
                document.getElementById('dic-next-btn').style.display = 'none';
                
                document.getElementById('writer-canvas').innerHTML = '';
                writer = HanziWriter.create('writer-canvas', seg, {
                    width: 280, height: 280, padding: 10, showOutline: false, showCharacter: false, strokeColor: '#0288d1', drawingWidth: 40
                });
                writer.quiz({ onComplete: () => { showReward(); setTimeout(dicNext, 800); } });
            } else {
                document.getElementById('dic-canvas-area').style.display = 'none';
                document.getElementById('dic-paper-area').style.display = 'block';
                document.getElementById('dic-text-display').innerText = "è«‹é»˜å¯«..."; 
                document.getElementById('dic-next-btn').style.display = 'block';
            }
            dicSpeak();
        }

        function dicSpeak() { speakText(dicSegments[dicIdx]); }
        function dicHint() { if(writer) writer.showOutline({ duration: 2000 }); }
        function dicNext() { dicIdx++; runDicStep(); }

        // --- 2. æ•¸å­¸ Level 1 (é€Ÿç®—) ---
        let m1Ans = 0;
        function initMathL1() {
            goTo('math-l1');
            const n1 = Math.floor(Math.random() * 12) + 1;
            const n2 = Math.floor(Math.random() * 9) + 1;
            const isMult = Math.random() > 0.5;
            m1Ans = isMult ? n1 * n2 : n1 + n2;
            document.getElementById('m1-q').innerText = isMult ? `${n1} Ã— ${n2}` : `${n1} + ${n2}`;
            document.getElementById('m1-ans').value = '';
            document.getElementById('m1-msg').innerText = '';
        }
        function checkMathL1() {
            if(parseInt(document.getElementById('m1-ans').value) === m1Ans) {
                showReward(); setTimeout(initMathL1, 1000);
            } else {
                document.getElementById('m1-msg').innerText = "å†è©¦ä¸€æ¬¡ï¼";
            }
        }

        // --- 3. æ•¸å­¸ Level 2 (æ‡‰ç”¨é¡Œ) ---
        let m2Current = {};
        const m2Templates = [
            { t: 'x', get: (n1,n2,i) => ({ txt: `æ¯ç›’æœ‰ ${n1} å€‹${i}ï¼Œè²·äº† ${n2} ç›’ï¼Œ<span class='keyword'>å…±æœ‰</span>å¤šå°‘å€‹ï¼Ÿ`, ans: n1*n2, hint: "æ¯ç›’ä¸€æ¨£å¤šï¼Œæ±‚ç¸½æ•¸ç”¨ä¹˜æ³•" }) },
            { t: 'Ã·', get: (n1,n2,i) => ({ txt: `æœ‰ ${n1*n2} å€‹${i}ï¼Œ<span class='keyword'>å¹³å‡åˆ†çµ¦</span> ${n2} äººï¼Œæ¯äººæœ‰å¹¾å€‹ï¼Ÿ`, ans: n1, hint: "å¹³å‡åˆ†é…ç”¨é™¤æ³•" }) },
            { t: '-', get: (n1,n2,i) => ({ txt: `æœ‰ ${n1+n2} å…ƒï¼Œè²·${i}ç”¨äº† ${n1} å…ƒï¼Œ<span class='keyword'>æ‰¾å›</span>å¤šå°‘å…ƒï¼Ÿ`, ans: n2, hint: "æ‰¾å›å°±æ˜¯å‰©ä¸‹çš„ï¼Œç”¨æ¸›æ³•" }) }
        ];
        function initMathL2() {
            goTo('math-l2');
            const temp = m2Templates[Math.floor(Math.random()*m2Templates.length)];
            const item = ['ç³–æœ','è²¼ç´™','è˜‹æœ','æ°£çƒ'][Math.floor(Math.random()*4)];
            const n1 = Math.floor(Math.random()*8)+2;
            const n2 = Math.floor(Math.random()*5)+2;
            m2Current = { ...temp.get(n1,n2,item), type: temp.t };
            
            document.getElementById('m2-text').innerHTML = m2Current.txt;
            document.getElementById('m2-step1').style.display = 'block';
            document.getElementById('m2-step2').style.display = 'none';
            document.getElementById('m2-next').style.display = 'none';
            
            // ç”Ÿæˆç¬¦è™ŸæŒ‰éˆ•
            const opsDiv = document.getElementById('m2-ops');
            opsDiv.innerHTML = '';
            ['+','-','x','Ã·'].forEach(op => {
                let btn = document.createElement('button');
                btn.className = 'btn';
                btn.innerText = op;
                btn.onclick = () => {
                    if(op === m2Current.type) {
                        speakText("è§€å¿µæ­£ç¢ºï¼");
                        document.getElementById('m2-step1').style.display = 'none';
                        document.getElementById('m2-step2').style.display = 'block';
                    } else speakText("ä¸å°å–”ï¼Œ" + m2Current.hint);
                }
                opsDiv.appendChild(btn);
            });
            speakText(document.getElementById('m2-text').innerText);
        }
        function checkMathL2Final() {
            if(parseInt(document.getElementById('m2-ans').value) === m2Current.ans) {
                showReward();
                document.getElementById('m2-next').style.display = 'block';
            } else speakText("ç®—éŒ¯äº†å†è©¦è©¦");
        }

        // --- 4. æ•¸å­¸ Level 3 (æ™‚é–“) ---
        let m3Ans = {h:0, m:0};
        const clockCanvas = document.getElementById('clock-canvas');
        const ctx = clockCanvas.getContext('2d');

        function drawClock(h, m) {
            ctx.clearRect(0,0,200,200);
            ctx.translate(100,100);
            
            // éŒ¶ç›¤
            ctx.beginPath(); ctx.arc(0,0,90,0,2*Math.PI); ctx.stroke();
            for(let i=1; i<=12; i++) {
                ctx.rotate(i * Math.PI/6); ctx.translate(0, -75); ctx.rotate(-i * Math.PI/6);
                ctx.fillText(i, -3, 3);
                ctx.rotate(i * Math.PI/6); ctx.translate(0, 75); ctx.rotate(-i * Math.PI/6);
            }
            // æŒ‡é‡
            drawHand((h%12)*Math.PI/6 + m*Math.PI/360, 50, 4, '#333'); // æ™‚
            drawHand(m*Math.PI/30, 70, 2, 'red'); // åˆ†
            ctx.translate(-100,-100);
        }
        function drawHand(pos, len, width, color) {
            ctx.beginPath(); ctx.strokeStyle = color; ctx.lineWidth = width;
            ctx.moveTo(0,0); ctx.rotate(pos); ctx.lineTo(0, -len); ctx.stroke(); ctx.rotate(-pos);
        }

        function initMathL3() {
            goTo('math-l3');
            document.getElementById('m3-h').value = ''; document.getElementById('m3-m').value = '';
            document.getElementById('m3-next').style.display = 'none';

            const mode = Math.random() > 0.5 ? 'analog' : 'duration';
            const h = Math.floor(Math.random()*12)+1;
            const m = Math.floor(Math.random()*12)*5;
            
            if(mode === 'analog') {
                clockCanvas.style.display = 'block';
                document.getElementById('digital-clock-wrap').style.display = 'none';
                drawClock(h, m);
                document.getElementById('m3-text').innerText = "è«‹å¯«å‡ºé˜é¢ä¸Šçš„æ™‚é–“ï¼š";
                m3Ans = {h, m};
            } else {
                // ç¶“éæ™‚é–“
                clockCanvas.style.display = 'none';
                document.getElementById('digital-clock-wrap').style.display = 'block';
                const dur = 30 + Math.floor(Math.random()*6)*10; // 30-80 mins
                document.getElementById('m3-d-clock').innerText = `${h}:${m<10?'0'+m:m}`;
                document.getElementById('m3-text').innerText = `ç¾åœ¨æ™‚é–“å¦‚åœ–ï¼Œç¶“é ${dur} åˆ†é˜å¾Œæ˜¯å¹¾é»ï¼Ÿ`;
                
                let totalM = m + dur;
                m3Ans.h = (h + Math.floor(totalM/60));
                if(m3Ans.h > 12) m3Ans.h -= 12;
                m3Ans.m = totalM % 60;
            }
            speakText(document.getElementById('m3-text').innerText);
        }
        function checkMathL3() {
            const uh = parseInt(document.getElementById('m3-h').value);
            const um = parseInt(document.getElementById('m3-m').value);
            if(uh === m3Ans.h && um === m3Ans.m) {
                showReward();
                document.getElementById('m3-next').style.display = 'block';
            } else speakText("æ™‚é–“ä¸å°å–”ï¼Œæ³¨æ„é€²ä½æˆ–çœ‹æ¸…æ¥šæŒ‡é‡");
        }

    </script>
</body>
</html>
