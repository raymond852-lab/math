if (gameMode === 'mix') {
    if (level === 1) {
        // Lv.1：簡單但加單位轉換
        const ops = ['+', '-', '×'];
        const op = ops[Math.floor(Math.random()*3)];
        let a = Math.floor(Math.random()*20)+5;
        let b = Math.floor(Math.random()*10)+2;
        if(op==='-') { if(a<b) [a,b]=[b,a]; correctMath=a-b; }
        else if(op==='×') { a=Math.floor(Math.random()*9)+2; b=Math.floor(Math.random()*9)+2; correctMath=a*b; }
        else correctMath=a+b;
        qHtml = `${a} ${op} ${b} = ? <br><small>（單位是「個」或「元」）</small>`;
    }
    else if (level === 2) {
        // Lv.2：全部兩步文字題（更難）
        const type = Math.floor(Math.random()*5);
        let n1, n2, n3, ans;
        if(type === 0) {
            n1 = Math.floor(Math.random()*30)+20;
            n2 = Math.floor(Math.random()*10)+5;
            n3 = Math.floor(Math.random()*5)+2;
            qHtml = `玉桂狗有 ${n1} 顆糖，送咗 ${n2} 顆畀朋友，<br>又吃了 ${n3} 顆，<br>仲剩幾多顆？`;
            ans = n1 - n2 - n3;
        } else if(type === 1) {
            n1 = Math.floor(Math.random()*6)+3;
            n2 = Math.floor(Math.random()*4)+2;
            n3 = Math.floor(Math.random()*5)+2;
            qHtml = `一盒有 ${n1} 枝筆，買咗 ${n2} 盒，<br>每枝賣 ${n3} 元，總共可以賣幾多錢？`;
            ans = n1 * n2 * n3;
        } else if(type === 2) {
            n1 = Math.floor(Math.random()*40)+20;
            n2 = Math.floor(Math.random()*15)+5;
            n3 = Math.floor(Math.random()*10)+3;
            qHtml = `小明有 ${n1} 張卡紙，用咗 ${n2} 張做手工，<br>媽媽又畀咗 ${n3} 張佢，<br>而家有幾多張？`;
            ans = n1 - n2 + n3;
        } else if(type === 3) {
            n1 = Math.floor(Math.random()*8)+3;
            n2 = Math.floor(Math.random()*6)+4;
            n3 = n1 * n2;
            qHtml = `有 ${n3} 粒糖果，要平均分畀 ${n2} 個小朋友，<br>每人可以分到幾粒？`;
            ans = n1;
        } else {
            n1 = Math.floor(Math.random()*5)+2;
            n2 = Math.floor(Math.random()*20)+10;
            n3 = Math.floor(Math.random()*30)+10;
            qHtml = `打工 ${n1} 小時，每小時 ${n2} 元，<br>老闆額外畀 ${n3} 元獎金，<br>總共賺咗幾多錢？`;
            ans = n1 * n2 + n3;
        }
        qHtml += `<br><small>（提示：可以用紙筆一步一步算）</small>`;
        correctMath = ans;
    }
    else if (level === 3) {
        // Lv.3：括號 + 多步
        let a = Math.floor(Math.random()*10)+5;
        let b = Math.floor(Math.random()*8)+2;
        let c = Math.floor(Math.random()*6)+2;
        let op1 = Math.random() > 0.5 ? '+' : '-';
        qHtml = `(${a} ${op1} ${b}) × ${c} = ?`;
        correctMath = op1 === '+' ? (a + b) * c : (a - b) * c;
    }
    else if (level === 4) {
        // Lv.4：超難（保留原 5 種 + 更嚴格計算）
        const type = Math.floor(Math.random() * 5);
        let n1, n2, n3, n4, ans;
        if (type === 0) {
            n1 = Math.floor(Math.random()*50)+30;
            n2 = Math.floor(Math.random()*10)+5;
            n3 = Math.floor(Math.random()*8)+3;
            qHtml = `一條繩長 ${n1} 厘米，剪咗 ${n2} 厘米畀小狗，<br>再剪 ${n3} 厘米畀玉桂狗，<br>仲剩幾多厘米？`;
            ans = n1 - n2 - n3;
        } else if (type === 1) {
            let people = Math.floor(Math.random()*4)+2;
            let perPerson = Math.floor(Math.random()*6)+2;
            n3 = people * perPerson;
            qHtml = `有一袋糖共 ${n3} 粒，<br>平均分畀 ${people} 個小朋友，<br>每人有幾粒？`;
            ans = perPerson;
        } else if (type === 2) {
            let chicken = Math.floor(Math.random()*5)+1;
            let rabbit = Math.floor(Math.random()*5)+1;
            let heads = chicken + rabbit;
            let legs = (chicken * 2) + (rabbit * 4);
            qHtml = `農場有雞同兔，數頭有 ${heads} 隻，<br>數腳有 ${legs} 隻。<br>請問有幾多隻雞？`;
            ans = chicken;
        } else if (type === 3) {
            n1 = Math.floor(Math.random()*4)+2;
            n2 = Math.floor(Math.random()*30)+20;
            n3 = Math.floor(Math.random()*50)+10;
            qHtml = `打工 ${n1} 小時，每小時 ${n2} 元，<br>老闆額外畀 ${n3} 元獎金，<br>總共賺咗幾多錢？`;
            ans = n1 * n2 + n3;
        } else {
            n1 = Math.floor(Math.random()*10)+5;
            n2 = Math.floor(Math.random()*20)+10;
            n3 = Math.floor(Math.random()*5)+2;
            qHtml = `玉桂狗吃了 ${n2} 顆糖後仲有 ${n3} 顆，<br>原本有幾多顆糖？`;
            ans = n2 + n3;
        }
        qHtml += `<br><small>（提示：可以用紙筆畫一畫喔！）</small>`;
        correctMath = ans;
    }
}
